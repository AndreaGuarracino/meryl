
const char *usage =
"usage: %s [personality] [options]\n"
"\n"
"where personality is:\n"
"        -P -- compute parameters\n"
"        -B -- build table\n"
"        -S -- scan table\n"
"        -M -- \"math\" operations\n"
"        -D -- dump table\n"
"\n"
"-P:  Given a sequence file (-s) or an upper limit on the\n"
"     number of mers in the file (-n), compute the table size\n"
"     (-t in build) to minimize the memory usage.\n"
"        -m #          (size of a mer; required)\n"
"        -s seq.fasta  (seq.fasta is scanned to determine the number of mers)\n"
"        -n #          (compute params assuming file with this many mers in it)\n"
"\n"
"     Only one of -s, -n need to be specified.  If both are given\n"
"     -s takes priority.\n"
"\n"
"\n"
"-B:  Given a sequence file (-s) and lots of parameters, compute\n"
"     the mer-count tables.  By default, both strands are processed.\n"
"        -f            (only build for the forward strand)\n"
"        -r            (only build for the reverse strand)\n"
"        -C            (use canonical mers, assumes both strands)\n"
"        -L #          (DON'T save mers that occur less than # times)\n"
"        -U #          (DON'T save mers that occur more than # times)\n"
"        -m #          (size of a mer; required)\n"
"        -t #          (size of the table, in bits)\n"
"        -H #          (force the hash width, in bits -- use with caution!)\n"
"        -s seq.fasta  (sequence to build the table for)\n"
"        -o tblprefix  (output table prefix)\n"
"        -v            (entertain the user)\n"
"\n"
"\n"
"-S:  Given a table, and a list of mers, print the count for each mer.\n"
"        -s tblprefix  (use these tables)\n"
"        -q mers.fasta (get the list of mers from here; the query)"
"\n"
"        -o            (output file name)\n"
"\n"
"        -d            (include the defline in the output)\n"
"        -e            (state the mer explicitly)\n"
"\n"
"        -c            (basic output; for each mer, just the count)\n"
"        -p            (position output; for each mer, the position of the mer and the count)\n"
"        -a            (count for every base)\n"
"\n"
"     -d and -e only apply to -c and -p\n"
"     -a prints the count for every base, with deflines\n"
"\n"
"\n"
"-M:  Given a list of tables, perform a math, logical or threshold operation.\n"
"     Unless specified, all operations take any number of databases.\n"
"\n"
"     Math operations are:\n"
"        min       count is the minimum count for all databases.  If the mer\n"
"                  does NOT exist in all databases, the mer has a zero count, and\n"
"                  is NOT in the output.\n"
"        minexist  count is the minimum count for all databases that contain the mer\n"
"        max       count is the maximum count for all databases\n"
"        add       count is sum of the counts for all databases\n"
"        sub       count is the first minus the second (binary only)\n"
"        abs       count is the absolute value of the first minus the second (binary only)\n"
"\n"
"     Logical operations are:\n"
"        and       outputs mer iff it exists in all databases\n"
"        nand      outputs mer iff it exists in at least one, but not all, databases\n"
"        or        outputs mer iff it exists in at least one database\n"
"        nor       outputs mer iff it doesn't exist in any database (synonym for -not)\n"
"        not       outputs mer iff it doesn't exist in any database (synonym for -nor)\n"
"        xor       outputs mer iff it exists in an odd number of databases\n"
"\n"
"     Threshold operations are:\n"
"        lessthan            outputs mer iff it has count < specified\n"
"        lessthanorequal     outputs mer iff it has count <= specified\n"
"        greaterthan         outputs mer iff it has count > specified\n"
"        greaterthanorequal  outputs mer iff it has count >= specified\n"
"        equal               outputs mer iff it has count == specified\n"
"     Threshold operations work on exactly one database.\n"
"\n"
"        -mask mf      (outputs mer iff it exists in mf, with count from the operation)\n"
"                      (MASKING IS NOT FULLY DEBUGGED!  USE AT YOUR OWN RISK!\n"
"        -s tblprefix  (use tblprefix as a database)\n"
"        -o tblprefix  (create this output)\n"
"        -v            (entertain the user)\n"
"\n"
"     NOTE:  Multiple tables are specified with multiple -s switches; e.g.:\n"
"              %s -M -add -s 1 -s 2 -s 3 -s 4 -o all\n"
"     NOTE:  It is NOT possible to specify more than one operation:\n"
"              %s -M -add -s 1 -s 2 -sub -s 3\n"
"            will NOT work.\n"
"\n"
"\n"
"-D:  Dump the table (not all of these work).\n"
"\n"
"     -Dt        Dump mers >= a threshold.  Use -n to specify the threshold.\n"
"     -Dc        Count the number of mers, distinct mers and unique mers.\n"
"     -Dp        Plot the distance between mers.\n"
"     -Dh        Dump (to stdout) a histogram of mer counts.\n"
"     -s         Read the count table from here (leave off the .mcdat or .mcidx).\n"
"\n"
"\n";
